# ADR-001: Выбор SQLite для storage

## Статус
Принято

## Контекст
Codex Aura нуждается в хранении графов зависимостей для последующего анализа. Требования:

- Локальное хранение без внешних зависимостей
- Поддержка сложных структур данных (JSON)
- ACID транзакции
- Простота развертывания
- Хорошая производительность для чтения/записи

## Рассмотренные варианты

### 1. Файловая система (JSON файлы)
- **Плюсы**: Простота, отсутствие зависимостей
- **Минусы**: Нет транзакций, проблемы с конкурентным доступом, сложный поиск

### 2. PostgreSQL/MySQL
- **Плюсы**: Полноценная СУБД, ACID, сложные запросы
- **Минусы**: Требует установки сервера, дополнительные зависимости

### 3. SQLite
- **Плюсы**: Встроенная БД, ACID, JSON поддержка, zero-config
- **Минусы**: Ограничения по конкурентности (один writer)

### 4. Redis/MongoDB
- **Плюсы**: Быстрое хранение JSON
- **Минусы**: Дополнительные зависимости, не подходит для локального использования

## Решение
Выбрана SQLite как основное хранилище.

## Обоснование
- **Zero dependencies**: SQLite встроена в Python
- **JSON поддержка**: Начиная с SQLite 3.9+ поддержка JSON
- **ACID**: Гарантирует целостность данных
- **Производительность**: Достаточная для типичного использования
- **Простота**: Не требует настройки сервера

## Последствия
- Использовать SQLAlchemy для ORM
- JSON поля для хранения графов
- Регулярные VACUUM операции для оптимизации
- Ограничение на одновременную запись (приемлемо для CLI/API использования)