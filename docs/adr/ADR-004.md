# ADR-004: API versioning

## Статус
Принято

## Контекст
Codex Aura предоставляет REST API для интеграции с другими инструментами. Требования:

- Стабильность API для клиентов
- Возможность эволюции API
- Четкая коммуникация изменений
- Поддержка нескольких версий одновременно

## Рассмотренные варианты

### 1. No versioning
- **Плюсы**: Простота
- **Минусы**: Breaking changes ломают клиентов

### 2. URL versioning (v1, v2)
- **Плюсы**: Явное версионирование, кэширование
- **Минусы**: Дублирование кода, сложность поддержки

### 3. Header versioning (Accept-Version)
- **Плюсы**: Чистые URLs, гибкость
- **Минусы**: Менее явное, сложнее кэширование

### 4. Semantic versioning
- **Плюсы**: Стандартизировано, понятно
- **Минусы**: Сложность для REST API

## Решение
URL-based versioning: `/api/v1/`, `/api/v2/`, etc.

## Обоснование
- **Явность**: Версия видна в URL
- **Кэширование**: Разные версии кэшируются отдельно
- **Документация**: Легко документировать разные версии
- **Миграция**: Клиенты могут мигрировать постепенно

## Последствия
- Все endpoints начинаются с `/api/v{version}/`
- Новая major версия = новый URL префикс
- Minor/patch версии backward compatible
- Депрекация старых версий с предупреждениями
- OpenAPI спецификация для каждой версии