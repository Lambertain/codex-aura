# generated by datamodel-codegen:
#   filename:  node.schema.json
#   timestamp: 2025-12-05T13:11:46+00:00

from __future__ import annotations

from enum import Enum
from typing import Dict, List, Optional

from pydantic import BaseModel, Field, conint, constr


class Type(Enum):
    file = 'file'
    class_ = 'class'
    function = 'function'


class Line(BaseModel):
    __root__: conint(ge=0)


class BlameInfo(BaseModel):
    primary_author: str = Field(..., description='Primary author of the file')
    contributors: List[str] = Field(
        ..., description='List of all contributors to the file'
    )
    author_distribution: Dict[constr(regex=r'.*'), conint(ge=0)] = Field(
        ...,
        description='Distribution of authorship across the file (author -> line count)',
    )


class Node(BaseModel):
    id: str = Field(..., description='Unique identifier for the node')
    type: Type = Field(..., description='Type of the node')
    name: str = Field(
        ..., description='Name of the entity (filename, class name, or function name)'
    )
    path: str = Field(..., description='Relative path to the file containing this node')
    lines: Optional[List[Line]] = Field(
        None,
        description='Start and end line numbers where the entity is defined',
        max_items=2,
        min_items=2,
    )
    docstring: Optional[str] = Field(
        None, description='Documentation string extracted from the code'
    )
    blame: Optional[BlameInfo] = Field(
        None, description='Git blame information for authorship tracking'
    )
